import{N as u}from"./index-B2HebM-Z.js";import{D as p,p as S,u as A}from"./service-Blihfj6M.js";import{f as P,e as v}from"./primevue-Cpy0qCi2.js";import{y as N,r,b as Y,c as O,u as t,d as n,L as i,F as f}from"./@vue-El9F00iI.js";import"./vue-router-DwT636uc.js";import"./@primeuix-DoH5r5kp.js";import"./@primevue-CPyEe4-z.js";/* empty css                   */import"./@master-24VFnj-k.js";import"./axios-upsvKRUO.js";const k={class:"mt:20 flex:row font:normal font:sans f:25"},g={class:"flex flex:row"},L={class:"flex:col w:50% mr:1%"},w={class:"flex:col w:50%"},U={__name:"ai",setup(y){const m=N("toast"),a=r({response:"",temp:"",isLoading:!1}),l=r({name:"* 請選擇系統",APSYSNO:"*",ncik:"請選擇系統"}),d=r([{name:"* 請選擇系統",APSYSNO:"*",ncik:"請選擇系統"},{name:"TM 高階主管",APSYSNO:"TM",ncik:"高階主管"},{name:"AC 會計系統",APSYSNO:"AC",ncik:"會計系統"},{name:"CA 出納系統",APSYSNO:"CA",ncik:"出納系統"},{name:"TX 媒體申報",APSYSNO:"TX",ncik:"媒體申報"},{name:"PU 估驗系統",APSYSNO:"PU",ncik:"估驗系統"},{name:"ES 估算系統",APSYSNO:"ES",ncik:"估算系統"},{name:"PS 人事系統",APSYSNO:"PS",ncik:"人事系統"},{name:"MS 物料倉管",APSYSNO:"MS",ncik:"物料倉管"},{name:"PT 工程進度",APSYSNO:"PT",ncik:"工程進度"},{name:"PL 年度預算",APSYSNO:"PL",ncik:"年度預算"},{name:"DV 土地開發",APSYSNO:"DV",ncik:"土地開發"},{name:"WS 水電估算",APSYSNO:"WS",ncik:"水電估算"},{name:"ST 鋼筋撿料",APSYSNO:"ST",ncik:"鋼筋撿料"},{name:"SA 銷售系統",APSYSNO:"SA",ncik:"銷售系統"},{name:"EC 變更追加減",APSYSNO:"EC",ncik:"變更追加減"},{name:"QC 品質查核",APSYSNO:"QC",ncik:"品質查核"},{name:"PA 銷售前置",APSYSNO:"PA",ncik:"銷售前置"},{name:"ADMISYS 績效考核",APSYSNO:"ADMISYS",ncik:"績效考核"},{name:"MAINTSYS 客戶服務",APSYSNO:"MAINTSYS",ncik:"客戶服務"},{name:"HEALTSYS 健康管理",APSYSNO:"HEALTSYS",ncik:"健康管理"}]),c=async o=>{if(l.value.APSYSNO=="*"){m.add({severity:"error",summary:"系統別錯誤",detail:"請先選擇系統",life:1e4});return}a.value.isLoading=!0;let s=new FormData;s.append("file",o[0]);try{await S("/app/"+l.value.APSYSNO).then(e=>{a.value.response=`AC 系統關閉! 移除元件!
移除了 `+e.data.count+` 個元件.
`,a.value.response=e.data.msg+`
`}).catch(e=>{throw console.error("error:",e),a.value.response=e.response.data.msg,e}),await A("put","/dll/",s).then(e=>{a.value.response+=o[0].name+` 上傳成功!
`,a.value.temp+=e.data.msg+`
`}).catch(e=>{throw console.error("error:",e),a.value.response=e.response.data.msg,e}),await S("/dll/"+l.value.APSYSNO,{dllpath:o[0].name}).then(e=>{a.value.response+="AP "+e.data.path+" 成功安裝到 "+l.value.APSYSNO+`.
`,a.value.temp+=e.data.msg+`
`}).catch(e=>{throw console.error("error:",e),a.value.response=e.response.data.msg,e}),a.value.response=a.value.response+`

`+a.value.temp,a.value.isLoading=!1,m.add({severity:"success",summary:"AP安裝成功",detail:o[0].name+" 已上傳並安裝到 "+l.value.APSYSNO,life:15e3})}catch(e){a.value.response=e.response.data.msg,m.add({severity:"success",summary:o[0].name+"安裝失敗",detail:e,life:15e3}),a.value.isLoading=!1}};return(o,s)=>(Y(),O(f,null,[t(u,{text:"AP 安裝"}),n("div",k,[n("div",g,[n("div",L,[s[2]||(s[2]=n("label",{class:"w:25% mr:5",for:"selcode"},"1.選擇系統",-1)),t(i(P),{class:"",id:"selcode",modelValue:l.value,"onUpdate:modelValue":s[0]||(s[0]=e=>l.value=e),options:d.value,optionLabel:"name",placeholder:"選擇系統",checkmark:"",highlightOnSelect:!1},null,8,["modelValue","options"]),s[3]||(s[3]=n("label",{class:"flex mt:15"},"2.載入AP程式(.DLL 並開始安裝)",-1)),t(p,{class:"flex mt:10",isLoading:a.value.isLoading,onHandleFileDrop:c},null,8,["isLoading"])]),n("div",w,[s[4]||(s[4]=n("label",{class:"flex mt:15"},"3.安裝結果",-1)),t(i(v),{class:"mt:15",modelValue:a.value.response,"onUpdate:modelValue":s[1]||(s[1]=e=>a.value.response=e),rows:"12",cols:"60",readonly:""},null,8,["modelValue"])]),s[5]||(s[5]=n("br",null,null,-1))])])],64))}};export{U as default};
