import{E as Y}from"./exceljs-DiBkd7Op.js";import{N as R}from"./index-CeSPOaTc.js";import{D as j,p as x,d as D,g as P,u as V}from"./DragUpload-DXlmm2Yc.js";import{g as K,e as F,a as d,c as u,f as h,h as U,i as S,j as _}from"./primevue-CbY-VKnM.js";import{x as z,e as B,b as p,o as M,f as G,s as r,h as o,L as n,q as c,y as l,F as W}from"./@vue-B4Rme-ED.js";import"./@master-hp_0R5gD.js";import"./vue-router-B47mcnGi.js";/* empty css                   */import"./axios-Cm0UX6qg.js";const J={getProductsData(){return[{id:"1000",code:"f230fh0g3",name:"Bamboo Watch",description:"Product Description",image:"bamboo-watch.jpg",price:65,category:"Accessories",quantity:24,inventoryStatus:"INSTOCK",rating:5},{id:"1001",code:"nvklal433",name:"Black Watch",description:"Product Description",image:"black-watch.jpg",price:72,category:"Accessories",quantity:61,inventoryStatus:"INSTOCK",rating:4},{id:"1002",code:"zz21cz3c1",name:"Blue Band",description:"Product Description",image:"blue-band.jpg",price:79,category:"Fitness",quantity:2,inventoryStatus:"LOWSTOCK",rating:3},{id:"1003",code:"244wgerg2",name:"Blue T-Shirt",description:"Product Description",image:"blue-t-shirt.jpg",price:29,category:"Clothing",quantity:25,inventoryStatus:"INSTOCK",rating:5},{id:"1004",code:"h456wer53",name:"Bracelet",description:"Product Description",image:"bracelet.jpg",price:15,category:"Accessories",quantity:73,inventoryStatus:"INSTOCK",rating:4},{id:"1005",code:"av2231fwg",name:"Brown Purse",description:"Product Description",image:"brown-purse.jpg",price:120,category:"Accessories",quantity:0,inventoryStatus:"OUTOFSTOCK",rating:4},{id:"1006",code:"bib36pfvm",name:"Chakra Bracelet",description:"Product Description",image:"chakra-bracelet.jpg",price:32,category:"Accessories",quantity:5,inventoryStatus:"LOWSTOCK",rating:3},{id:"1007",code:"mbvjkgip5",name:"Galaxy Earrings",description:"Product Description",image:"galaxy-earrings.jpg",price:34,category:"Accessories",quantity:23,inventoryStatus:"INSTOCK",rating:5},{id:"1008",code:"vbb124btr",name:"Game Controller",description:"Product Description",image:"game-controller.jpg",price:99,category:"Electronics",quantity:2,inventoryStatus:"LOWSTOCK",rating:4},{id:"1009",code:"cm230f032",name:"Gaming Set",description:"Product Description",image:"gaming-set.jpg",price:299,category:"Electronics",quantity:63,inventoryStatus:"INSTOCK",rating:3},{id:"1010",code:"plb34234v",name:"Gold Phone Case",description:"Product Description",image:"gold-phone-case.jpg",price:24,category:"Accessories",quantity:0,inventoryStatus:"OUTOFSTOCK",rating:4},{id:"1011",code:"4920nnc2d",name:"Green Earbuds",description:"Product Description",image:"green-earbuds.jpg",price:89,category:"Electronics",quantity:23,inventoryStatus:"INSTOCK",rating:4},{id:"1012",code:"250vm23cc",name:"Green T-Shirt",description:"Product Description",image:"green-t-shirt.jpg",price:49,category:"Clothing",quantity:74,inventoryStatus:"INSTOCK",rating:5},{id:"1013",code:"fldsmn31b",name:"Grey T-Shirt",description:"Product Description",image:"grey-t-shirt.jpg",price:48,category:"Clothing",quantity:0,inventoryStatus:"OUTOFSTOCK",rating:3},{id:"1014",code:"waas1x2as",name:"Headphones",description:"Product Description",image:"headphones.jpg",price:175,category:"Electronics",quantity:8,inventoryStatus:"LOWSTOCK",rating:5},{id:"1015",code:"vb34btbg5",name:"Light Green T-Shirt",description:"Product Description",image:"light-green-t-shirt.jpg",price:49,category:"Clothing",quantity:34,inventoryStatus:"INSTOCK",rating:4},{id:"1016",code:"k8l6j58jl",name:"Lime Band",description:"Product Description",image:"lime-band.jpg",price:79,category:"Fitness",quantity:12,inventoryStatus:"INSTOCK",rating:3},{id:"1017",code:"v435nn85n",name:"Mini Speakers",description:"Product Description",image:"mini-speakers.jpg",price:85,category:"Clothing",quantity:42,inventoryStatus:"INSTOCK",rating:4},{id:"1018",code:"09zx9c0zc",name:"Painted Phone Case",description:"Product Description",image:"painted-phone-case.jpg",price:56,category:"Accessories",quantity:41,inventoryStatus:"INSTOCK",rating:5},{id:"1019",code:"mnb5mb2m5",name:"Pink Band",description:"Product Description",image:"pink-band.jpg",price:79,category:"Fitness",quantity:63,inventoryStatus:"INSTOCK",rating:4},{id:"1020",code:"r23fwf2w3",name:"Pink Purse",description:"Product Description",image:"pink-purse.jpg",price:110,category:"Accessories",quantity:0,inventoryStatus:"OUTOFSTOCK",rating:4},{id:"1021",code:"pxpzczo23",name:"Purple Band",description:"Product Description",image:"purple-band.jpg",price:79,category:"Fitness",quantity:6,inventoryStatus:"LOWSTOCK",rating:3},{id:"1022",code:"2c42cb5cb",name:"Purple Gemstone Necklace",description:"Product Description",image:"purple-gemstone-necklace.jpg",price:45,category:"Accessories",quantity:62,inventoryStatus:"INSTOCK",rating:4},{id:"1023",code:"5k43kkk23",name:"Purple T-Shirt",description:"Product Description",image:"purple-t-shirt.jpg",price:49,category:"Clothing",quantity:2,inventoryStatus:"LOWSTOCK",rating:5},{id:"1024",code:"lm2tny2k4",name:"Shoes",description:"Product Description",image:"shoes.jpg",price:64,category:"Clothing",quantity:0,inventoryStatus:"INSTOCK",rating:4},{id:"1025",code:"nbm5mv45n",name:"Sneakers",description:"Product Description",image:"sneakers.jpg",price:78,category:"Clothing",quantity:52,inventoryStatus:"INSTOCK",rating:4},{id:"1026",code:"zx23zc42c",name:"Teal T-Shirt",description:"Product Description",image:"teal-t-shirt.jpg",price:49,category:"Clothing",quantity:3,inventoryStatus:"LOWSTOCK",rating:3},{id:"1027",code:"acvx872gc",name:"Yellow Earbuds",description:"Product Description",image:"yellow-earbuds.jpg",price:89,category:"Electronics",quantity:35,inventoryStatus:"INSTOCK",rating:3},{id:"1028",code:"tx125ck42",name:"Yoga Mat",description:"Product Description",image:"yoga-mat.jpg",price:20,category:"Fitness",quantity:15,inventoryStatus:"INSTOCK",rating:5},{id:"1029",code:"gwuby345v",name:"Yoga Set",description:"Product Description",image:"yoga-set.jpg",price:20,category:"Fitness",quantity:25,inventoryStatus:"INSTOCK",rating:8}]},getProductsWithOrdersData(){return[{id:"1000",code:"f230fh0g3",name:"Bamboo Watch",description:"Product Description",image:"bamboo-watch.jpg",price:65,category:"Accessories",quantity:24,inventoryStatus:"INSTOCK",rating:5,orders:[{id:"1000-0",productCode:"f230fh0g3",date:"2020-09-13",amount:65,quantity:1,customer:"David James",status:"PENDING"},{id:"1000-1",productCode:"f230fh0g3",date:"2020-05-14",amount:130,quantity:2,customer:"Leon Rodrigues",status:"DELIVERED"},{id:"1000-2",productCode:"f230fh0g3",date:"2019-01-04",amount:65,quantity:1,customer:"Juan Alejandro",status:"RETURNED"},{id:"1000-3",productCode:"f230fh0g3",date:"2020-09-13",amount:195,quantity:3,customer:"Claire Morrow",status:"CANCELLED"}]},{id:"1001",code:"nvklal433",name:"Black Watch",description:"Product Description",image:"black-watch.jpg",price:72,category:"Accessories",quantity:61,inventoryStatus:"INSTOCK",rating:4,orders:[{id:"1001-0",productCode:"nvklal433",date:"2020-05-14",amount:72,quantity:1,customer:"Maisha Jefferson",status:"DELIVERED"},{id:"1001-1",productCode:"nvklal433",date:"2020-02-28",amount:144,quantity:2,customer:"Octavia Murillo",status:"PENDING"}]},{id:"1002",code:"zz21cz3c1",name:"Blue Band",description:"Product Description",image:"blue-band.jpg",price:79,category:"Fitness",quantity:2,inventoryStatus:"LOWSTOCK",rating:3,orders:[{id:"1002-0",productCode:"zz21cz3c1",date:"2020-07-05",amount:79,quantity:1,customer:"Stacey Leja",status:"DELIVERED"},{id:"1002-1",productCode:"zz21cz3c1",date:"2020-02-06",amount:79,quantity:1,customer:"Ashley Wickens",status:"DELIVERED"}]},{id:"1003",code:"244wgerg2",name:"Blue T-Shirt",description:"Product Description",image:"blue-t-shirt.jpg",price:29,category:"Clothing",quantity:25,inventoryStatus:"INSTOCK",rating:5,orders:[]},{id:"1004",code:"h456wer53",name:"Bracelet",description:"Product Description",image:"bracelet.jpg",price:15,category:"Accessories",quantity:73,inventoryStatus:"INSTOCK",rating:4,orders:[{id:"1004-0",productCode:"h456wer53",date:"2020-09-05",amount:60,quantity:4,customer:"Mayumi Misaki",status:"PENDING"},{id:"1004-1",productCode:"h456wer53",date:"2019-04-16",amount:2,quantity:30,customer:"Francesco Salvatore",status:"DELIVERED"}]},{id:"1005",code:"av2231fwg",name:"Brown Purse",description:"Product Description",image:"brown-purse.jpg",price:120,category:"Accessories",quantity:0,inventoryStatus:"OUTOFSTOCK",rating:4,orders:[{id:"1005-0",productCode:"av2231fwg",date:"2020-01-25",amount:120,quantity:1,customer:"Isabel Sinclair",status:"RETURNED"},{id:"1005-1",productCode:"av2231fwg",date:"2019-03-12",amount:240,quantity:2,customer:"Lionel Clifford",status:"DELIVERED"},{id:"1005-2",productCode:"av2231fwg",date:"2019-05-05",amount:120,quantity:1,customer:"Cody Chavez",status:"DELIVERED"}]},{id:"1006",code:"bib36pfvm",name:"Chakra Bracelet",description:"Product Description",image:"chakra-bracelet.jpg",price:32,category:"Accessories",quantity:5,inventoryStatus:"LOWSTOCK",rating:3,orders:[{id:"1006-0",productCode:"bib36pfvm",date:"2020-02-24",amount:32,quantity:1,customer:"Arvin Darci",status:"DELIVERED"},{id:"1006-1",productCode:"bib36pfvm",date:"2020-01-14",amount:64,quantity:2,customer:"Izzy Jones",status:"PENDING"}]},{id:"1007",code:"mbvjkgip5",name:"Galaxy Earrings",description:"Product Description",image:"galaxy-earrings.jpg",price:34,category:"Accessories",quantity:23,inventoryStatus:"INSTOCK",rating:5,orders:[{id:"1007-0",productCode:"mbvjkgip5",date:"2020-06-19",amount:34,quantity:1,customer:"Jennifer Smith",status:"DELIVERED"}]},{id:"1008",code:"vbb124btr",name:"Game Controller",description:"Product Description",image:"game-controller.jpg",price:99,category:"Electronics",quantity:2,inventoryStatus:"LOWSTOCK",rating:4,orders:[{id:"1008-0",productCode:"vbb124btr",date:"2020-01-05",amount:99,quantity:1,customer:"Jeanfrancois David",status:"DELIVERED"},{id:"1008-1",productCode:"vbb124btr",date:"2020-01-19",amount:198,quantity:2,customer:"Ivar Greenwood",status:"RETURNED"}]},{id:"1009",code:"cm230f032",name:"Gaming Set",description:"Product Description",image:"gaming-set.jpg",price:299,category:"Electronics",quantity:63,inventoryStatus:"INSTOCK",rating:3,orders:[{id:"1009-0",productCode:"cm230f032",date:"2020-06-24",amount:299,quantity:1,customer:"Kadeem Mujtaba",status:"PENDING"},{id:"1009-1",productCode:"cm230f032",date:"2020-05-11",amount:299,quantity:1,customer:"Ashley Wickens",status:"DELIVERED"},{id:"1009-2",productCode:"cm230f032",date:"2019-02-07",amount:299,quantity:1,customer:"Julie Johnson",status:"DELIVERED"},{id:"1009-3",productCode:"cm230f032",date:"2020-04-26",amount:299,quantity:1,customer:"Tony Costa",status:"CANCELLED"}]},{id:"1010",code:"plb34234v",name:"Gold Phone Case",description:"Product Description",image:"gold-phone-case.jpg",price:24,category:"Accessories",quantity:0,inventoryStatus:"OUTOFSTOCK",rating:4,orders:[{id:"1010-0",productCode:"plb34234v",date:"2020-02-04",amount:24,quantity:1,customer:"James Butt",status:"DELIVERED"},{id:"1010-1",productCode:"plb34234v",date:"2020-05-05",amount:48,quantity:2,customer:"Josephine Darakjy",status:"DELIVERED"}]},{id:"1011",code:"4920nnc2d",name:"Green Earbuds",description:"Product Description",image:"green-earbuds.jpg",price:89,category:"Electronics",quantity:23,inventoryStatus:"INSTOCK",rating:4,orders:[{id:"1011-0",productCode:"4920nnc2d",date:"2020-06-01",amount:89,quantity:1,customer:"Art Venere",status:"DELIVERED"}]},{id:"1012",code:"250vm23cc",name:"Green T-Shirt",description:"Product Description",image:"green-t-shirt.jpg",price:49,category:"Clothing",quantity:74,inventoryStatus:"INSTOCK",rating:5,orders:[{id:"1012-0",productCode:"250vm23cc",date:"2020-02-05",amount:49,quantity:1,customer:"Lenna Paprocki",status:"DELIVERED"},{id:"1012-1",productCode:"250vm23cc",date:"2020-02-15",amount:49,quantity:1,customer:"Donette Foller",status:"PENDING"}]},{id:"1013",code:"fldsmn31b",name:"Grey T-Shirt",description:"Product Description",image:"grey-t-shirt.jpg",price:48,category:"Clothing",quantity:0,inventoryStatus:"OUTOFSTOCK",rating:3,orders:[{id:"1013-0",productCode:"fldsmn31b",date:"2020-04-01",amount:48,quantity:1,customer:"Simona Morasca",status:"DELIVERED"}]},{id:"1014",code:"waas1x2as",name:"Headphones",description:"Product Description",image:"headphones.jpg",price:175,category:"Electronics",quantity:8,inventoryStatus:"LOWSTOCK",rating:5,orders:[{id:"1014-0",productCode:"waas1x2as",date:"2020-05-15",amount:175,quantity:1,customer:"Lenna Paprocki",status:"DELIVERED"},{id:"1014-1",productCode:"waas1x2as",date:"2020-01-02",amount:175,quantity:1,customer:"Donette Foller",status:"CANCELLED"}]},{id:"1015",code:"vb34btbg5",name:"Light Green T-Shirt",description:"Product Description",image:"light-green-t-shirt.jpg",price:49,category:"Clothing",quantity:34,inventoryStatus:"INSTOCK",rating:4,orders:[{id:"1015-0",productCode:"vb34btbg5",date:"2020-07-02",amount:98,quantity:2,customer:"Mitsue Tollner",status:"DELIVERED"}]},{id:"1016",code:"k8l6j58jl",name:"Lime Band",description:"Product Description",image:"lime-band.jpg",price:79,category:"Fitness",quantity:12,inventoryStatus:"INSTOCK",rating:3,orders:[]},{id:"1017",code:"v435nn85n",name:"Mini Speakers",description:"Product Description",image:"mini-speakers.jpg",price:85,category:"Clothing",quantity:42,inventoryStatus:"INSTOCK",rating:4,orders:[{id:"1017-0",productCode:"v435nn85n",date:"2020-07-12",amount:85,quantity:1,customer:"Minna Amigon",status:"DELIVERED"}]},{id:"1018",code:"09zx9c0zc",name:"Painted Phone Case",description:"Product Description",image:"painted-phone-case.jpg",price:56,category:"Accessories",quantity:41,inventoryStatus:"INSTOCK",rating:5,orders:[{id:"1018-0",productCode:"09zx9c0zc",date:"2020-07-01",amount:56,quantity:1,customer:"Abel Maclead",status:"DELIVERED"},{id:"1018-1",productCode:"09zx9c0zc",date:"2020-05-02",amount:56,quantity:1,customer:"Minna Amigon",status:"RETURNED"}]},{id:"1019",code:"mnb5mb2m5",name:"Pink Band",description:"Product Description",image:"pink-band.jpg",price:79,category:"Fitness",quantity:63,inventoryStatus:"INSTOCK",rating:4,orders:[]},{id:"1020",code:"r23fwf2w3",name:"Pink Purse",description:"Product Description",image:"pink-purse.jpg",price:110,category:"Accessories",quantity:0,inventoryStatus:"OUTOFSTOCK",rating:4,orders:[{id:"1020-0",productCode:"r23fwf2w3",date:"2020-05-29",amount:110,quantity:1,customer:"Kiley Caldarera",status:"DELIVERED"},{id:"1020-1",productCode:"r23fwf2w3",date:"2020-02-11",amount:220,quantity:2,customer:"Graciela Ruta",status:"DELIVERED"}]},{id:"1021",code:"pxpzczo23",name:"Purple Band",description:"Product Description",image:"purple-band.jpg",price:79,category:"Fitness",quantity:6,inventoryStatus:"LOWSTOCK",rating:3,orders:[{id:"1021-0",productCode:"pxpzczo23",date:"2020-02-02",amount:79,quantity:1,customer:"Cammy Albares",status:"DELIVERED"}]},{id:"1022",code:"2c42cb5cb",name:"Purple Gemstone Necklace",description:"Product Description",image:"purple-gemstone-necklace.jpg",price:45,category:"Accessories",quantity:62,inventoryStatus:"INSTOCK",rating:4,orders:[{id:"1022-0",productCode:"2c42cb5cb",date:"2020-06-29",amount:45,quantity:1,customer:"Mattie Poquette",status:"DELIVERED"},{id:"1022-1",productCode:"2c42cb5cb",date:"2020-02-11",amount:135,quantity:3,customer:"Meaghan Garufi",status:"DELIVERED"}]},{id:"1023",code:"5k43kkk23",name:"Purple T-Shirt",description:"Product Description",image:"purple-t-shirt.jpg",price:49,category:"Clothing",quantity:2,inventoryStatus:"LOWSTOCK",rating:5,orders:[{id:"1023-0",productCode:"5k43kkk23",date:"2020-04-15",amount:49,quantity:1,customer:"Gladys Rim",status:"RETURNED"}]},{id:"1024",code:"lm2tny2k4",name:"Shoes",description:"Product Description",image:"shoes.jpg",price:64,category:"Clothing",quantity:0,inventoryStatus:"INSTOCK",rating:4,orders:[]},{id:"1025",code:"nbm5mv45n",name:"Sneakers",description:"Product Description",image:"sneakers.jpg",price:78,category:"Clothing",quantity:52,inventoryStatus:"INSTOCK",rating:4,orders:[{id:"1025-0",productCode:"nbm5mv45n",date:"2020-02-19",amount:78,quantity:1,customer:"Yuki Whobrey",status:"DELIVERED"},{id:"1025-1",productCode:"nbm5mv45n",date:"2020-05-21",amount:78,quantity:1,customer:"Fletcher Flosi",status:"PENDING"}]},{id:"1026",code:"zx23zc42c",name:"Teal T-Shirt",description:"Product Description",image:"teal-t-shirt.jpg",price:49,category:"Clothing",quantity:3,inventoryStatus:"LOWSTOCK",rating:3,orders:[{id:"1026-0",productCode:"zx23zc42c",date:"2020-04-24",amount:98,quantity:2,customer:"Bette Nicka",status:"DELIVERED"}]},{id:"1027",code:"acvx872gc",name:"Yellow Earbuds",description:"Product Description",image:"yellow-earbuds.jpg",price:89,category:"Electronics",quantity:35,inventoryStatus:"INSTOCK",rating:3,orders:[{id:"1027-0",productCode:"acvx872gc",date:"2020-01-29",amount:89,quantity:1,customer:"Veronika Inouye",status:"DELIVERED"},{id:"1027-1",productCode:"acvx872gc",date:"2020-06-11",amount:89,quantity:1,customer:"Willard Kolmetz",status:"DELIVERED"}]},{id:"1028",code:"tx125ck42",name:"Yoga Mat",description:"Product Description",image:"yoga-mat.jpg",price:20,category:"Fitness",quantity:15,inventoryStatus:"INSTOCK",rating:5,orders:[]},{id:"1029",code:"gwuby345v",name:"Yoga Set",description:"Product Description",image:"yoga-set.jpg",price:20,category:"Fitness",quantity:25,inventoryStatus:"INSTOCK",rating:8,orders:[{id:"1029-0",productCode:"gwuby345v",date:"2020-02-14",amount:4,quantity:80,customer:"Maryann Royster",status:"DELIVERED"}]}]},getProductsMini(){return Promise.resolve(this.getProductsData().slice(0,5))},getProductsSmall(){return Promise.resolve(this.getProductsData().slice(0,10))},getProducts(){return Promise.resolve(this.getProductsData())},getProductsWithOrdersSmall(){return Promise.resolve(this.getProductsWithOrdersData().slice(0,10))},getProductsWithOrders(){return Promise.resolve(this.getProductsWithOrdersData())}},H={class:"mt:20 flex font:normal font:sans f:20"},Z={class:"flex:col mr:2% w:40%"},$={class:"flex flex:row mb:10"},X=o("label",{class:"w:20%",for:"selcode"},"1.選擇系統",-1),Q={class:"flex flex:row mb:5"},ee=o("label",{class:"w:20%",for:"APSYSNO"},"系統編號",-1),te={class:"flex flex:row mb:5"},ae=o("label",{class:"w:20%",for:"VERSION"},"版本",-1),ie={class:"flex flex:row mb:5"},oe=o("label",{class:"w:20%",for:"NDATE"},"發布日期",-1),re={class:"flex flex:row mb:5"},ne=o("label",{class:"w:20%",for:"FileName"},"檔案名稱",-1),se={class:"flex flex:row mb:15"},ce=o("label",{class:"w:20%",for:"FILESIZE"},"檔案大小",-1),de={class:"flex flex:row mb:10"},ue=o("label",{class:"w:20%",for:"SUBJECT"},"3.更新標題",-1),le={class:"flex flex:row mb:10"},me={class:"w:20% flex:col"},pe=o("label",{class:"",for:"DESCRIPTION"},"4.更新詳述",-1),ge={class:"flex flex:col"},Se=o("label",null,"5.載入程式執行檔(.EXE 並開始上傳主機)",-1),ye={class:"flex:col"},ve={class:"flex flex:row mb:10"},Ee={class:"flex flex:row"},Ce={class:"flex"},qe={__name:"cl",setup(De){const s=z("toast"),O=K();B(()=>{J.getProductsMini().then(t=>N.value=t)});const N=p(),y=p(),f=()=>{if(e.value.APSYSNO!=""){if(e.value.update==""){s.add({severity:"error",summary:"刪除錯誤",detail:"請先選擇紀錄",life:1e4});return}O.require({message:"確認刪除版本 "+e.value.version+" 的紀錄?",header:"Confirm",icon:"pi pi-exclamation-triangle",rejectClass:"p-button-secondary p-button-outlined",acceptLabel:"OK",rejectLabel:"Cancel",accept:()=>{A()},reject:()=>{}})}},b=async()=>{const t=new Y.Workbook,a=t.addWorksheet("系統更新紀錄",{properties:{defaultRowHeight:17},pageSetup:{fitToPage:!0,fitToWidth:1,fitToHeight:0},views:[{}]});a.columns=[{header:"",key:"Computer",width:15,type:"string",style:{font:{size:10,name:"細明體"}}},{header:"",key:"UpDate",width:25,type:"string",style:{font:{size:10,name:"細明體"}}},{header:"",key:"Msg",width:25,type:"string",style:{font:{size:10,name:"細明體"}}},{header:"",key:"Memo",width:33,type:"string",style:{font:{size:10,name:"細明體"}}}],a.addRow({Computer:"系統更新紀錄"}),a.getRow(2).alignment={horizontal:"center"},a.mergeCells(2,1,2,4),a.addRow({Computer:"系統編號："+e.value.selectedsystem.name}),a.mergeCells(3,1,3,4),a.addRow({Computer:"版本",UpDate:"發布日期",Msg:"更新標題",Memo:"更新詳述"}),a.getRow(4).alignment={horizontal:"center"},a.addRows(e.value.col.reverse(),3),a.getRow(2).font={size:12};const i=await t.xlsx.writeBuffer(),L=new Blob([i],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),C=window.URL.createObjectURL(L),g=document.createElement("a");g.href=C,g.download="系統更新紀錄.xlsx",g.click(),window.URL.revokeObjectURL(C)},T=t=>{e.value.update=t.data.UpDate,e.value.version=t.data.Computer},I=()=>{e.value.update="",e.value.version=""},e=p({version:"",update:"",SUBJECT:"",DESCRIPTION:"",isLoading:!1,isDragging:!1,selectedsystem:{name:"* 請選擇系統",APSYSNO:"*",ncik:"請選擇系統"},APSYSNO:"",VERSION:"",NDATE:"",FileName:"",FILESIZE:null,col:null}),k=p([{name:"* 請選擇系統",APSYSNO:"*",ncik:"請選擇系統"},{name:"TMGRSYS 高階主管",APSYSNO:"TMGRSYS",ncik:"高階主管"},{name:"ACNTSYS 會計系統",APSYSNO:"ACNTSYS",ncik:"會計系統"},{name:"CASHSYS 出納系統",APSYSNO:"CASHSYS",ncik:"出納系統"},{name:"TAXAPSYS 媒體申報",APSYSNO:"TAXAPSYS",ncik:"媒體申報"},{name:"EPURCSYS 估驗系統",APSYSNO:"EPURCSYS",ncik:"估驗系統"},{name:"EESTISYS 估算系統",APSYSNO:"EESTISYS",ncik:"估算系統"},{name:"PERSNSYS 人事系統",APSYSNO:"PERSNSYS",ncik:"人事系統"},{name:"MSIOSYS 物料倉管",APSYSNO:"MSIOSYS",ncik:"物料倉管"},{name:"PERTSYS 工程進度",APSYSNO:"PERTSYS",ncik:"工程進度"},{name:"PLANSYS 年度預算",APSYSNO:"PLANSYS",ncik:"年度預算"},{name:"DVEPSYS 土地開發",APSYSNO:"DVEPSYS",ncik:"土地開發"},{name:"WSESSYS 水電估算",APSYSNO:"WSESSYS",ncik:"水電估算"},{name:"STEELSYS 鋼筋撿料",APSYSNO:"STEELSYS",ncik:"鋼筋撿料"},{name:"SALESYS 銷售系統",APSYSNO:"SALESYS",ncik:"銷售系統"},{name:"ECHGSYS 變更追加減",APSYSNO:"ECHGSYS",ncik:"變更追加減"},{name:"CMISCCSYS 整合營建桌面",APSYSNO:"CMISCCSYS",ncik:"整合營建桌面"},{name:"CMISC_工地 整合工地桌面",APSYSNO:"CMISC_工地",ncik:"整合工地桌面"},{name:"QCTLSYS 品質查核",APSYSNO:"QCTLSYS",ncik:"品質查核"},{name:"PSALESYS 銷售前置",APSYSNO:"PSALESYS",ncik:"銷售前置"},{name:"ADMISYS 績效考核",APSYSNO:"ADMISYS",ncik:"績效考核"},{name:"MAINTSYS 客戶服務",APSYSNO:"MAINTSYS",ncik:"客戶服務"},{name:"HEALTSYS 健康管理",APSYSNO:"HEALTSYS",ncik:"健康管理"}]);e.value.isLoading=!1;const q=()=>{e.value.APSYSNO!=""&&x("/cl/cl/"+e.value.APSYSNO,{SUBJECT:e.value.SUBJECT,DESCRIPTION:e.value.DESCRIPTION}).then(t=>{m()}).catch(t=>{console.error("error:",t)})},w=()=>{e.value.APSYSNO!=""&&D("/cl/cl/"+e.value.APSYSNO).then(t=>{m()}).catch(t=>{console.error("error:",t)})},A=()=>{D("/cl/history/"+e.value.APSYSNO,{up_date:e.value.update,version:e.value.version}).then(t=>{e.value.col=t.data.data,v()}).catch(t=>{console.error("error:",t)})},m=()=>{if(e.value.selectedsystem.APSYSNO=="*"){s.add({severity:"error",summary:"系統別錯誤",detail:"請先選擇系統",life:1e4});return}P("/cl/pd/"+e.value.selectedsystem.APSYSNO).then(t=>{t.data.data.Subject==""?(e.value.response=JSON.stringify(t.data,null,1),e.value.APSYSNO=e.value.selectedsystem.APSYSNO,e.value.VERSION="",e.value.NDATE=new Date(Date.now()).toLocaleString(),e.value.FileName="",e.value.FILESIZE="",e.value.SUBJECT=e.value.selectedsystem.ncik,e.value.DESCRIPTION=""):(e.value.response=JSON.stringify(t.data.data,null,1),e.value.APSYSNO=t.data.data.Apsysno,e.value.VERSION=t.data.data.Version,e.value.NDATE=new Date(t.data.data.Ndate).toLocaleString(),e.value.FileName=t.data.data.Filename,e.value.FILESIZE=t.data.data.Filesize,e.value.SUBJECT=t.data.data.Subject,e.value.DESCRIPTION=t.data.data.Description),v()}).catch(t=>{s.add({severity:"error",summary:"錯誤",detail:t,life:1e4}),console.error("error:",t)})},v=()=>{P("/cl/history/"+e.value.APSYSNO).then(t=>{e.value.col=t.data.data}).catch(t=>{console.error("error:",t)})},E=t=>{if(e.value.selectedsystem.APSYSNO=="*"){s.add({severity:"error",summary:"系統別錯誤",detail:"請先選擇系統",life:1e4});return}if(e.value.APSYSNO==""){s.add({severity:"error",summary:"錯誤",detail:"請先查詢系統資料",life:1e4});return}e.value.Extension=".exe";let a=new FormData;a.append("file",t[0]),a.append("SUBJECT",e.value.SUBJECT),a.append("DESCRIPTION",e.value.DESCRIPTION),e.value.isLoading=!0,V("put","/cl/cl/"+e.value.selectedsystem.APSYSNO,a).then(i=>{e.value.isLoading=!1,s.add({severity:"success",summary:"上傳成功",detail:t[0].name+" 已上傳到 "+e.value.selectedsystem.APSYSNO+`
`+i.data.msg,life:15e3}),m()}).catch(i=>{e.value.isLoading=!1,s.add({severity:"error",summary:"上傳失敗",detail:i.response.data.msg,life:15e3}),console.error("error:",i)})};return(t,a)=>(M(),G(W,null,[r(R,{text:"CL 更新"}),o("div",H,[o("div",Z,[o("div",$,[X,r(n(F),{class:"mr:10",id:"selcode",modelValue:e.value.selectedsystem,"onUpdate:modelValue":a[0]||(a[0]=i=>e.value.selectedsystem=i),options:k.value,optionLabel:"name",placeholder:"選擇系統",checkmark:"",highlightOnSelect:!0},null,8,["modelValue","options"]),r(n(d),{class:"mr:5",onClick:m},{default:c(()=>[l("2.查詢")]),_:1}),r(n(d),{class:"ml:5",onClick:w},{default:c(()=>[l("刪除")]),_:1})]),o("div",Q,[ee,r(n(u),{modelValue:e.value.APSYSNO,"onUpdate:modelValue":a[1]||(a[1]=i=>e.value.APSYSNO=i),class:"w:80%",id:"APSYSNO",disabled:"",placeholder:""},null,8,["modelValue"])]),o("div",te,[ae,r(n(u),{modelValue:e.value.VERSION,"onUpdate:modelValue":a[2]||(a[2]=i=>e.value.VERSION=i),class:"w:80%",id:"VERSION",disabled:"",placeholder:""},null,8,["modelValue"])]),o("div",ie,[oe,r(n(u),{modelValue:e.value.NDATE,"onUpdate:modelValue":a[3]||(a[3]=i=>e.value.NDATE=i),class:"w:80%",id:"NDATE",disabled:"",placeholder:""},null,8,["modelValue"])]),o("div",re,[ne,r(n(u),{modelValue:e.value.FileName,"onUpdate:modelValue":a[4]||(a[4]=i=>e.value.FileName=i),class:"w:80%",id:"FileName",disabled:"",placeholder:""},null,8,["modelValue"])]),o("div",se,[ce,r(n(u),{modelValue:e.value.FILESIZE,"onUpdate:modelValue":a[5]||(a[5]=i=>e.value.FILESIZE=i),class:"w:80%",id:"FILESIZE",disabled:"",placeholder:""},null,8,["modelValue"])]),o("div",de,[ue,r(n(h),{modelValue:e.value.SUBJECT,"onUpdate:modelValue":a[6]||(a[6]=i=>e.value.SUBJECT=i),class:"w:80%",id:"SUBJECT",rows:"1",cols:"50"},null,8,["modelValue"])]),o("div",le,[o("div",me,[pe,r(n(d),{class:"mt:10 ml:10 mr:10 w:fit",onClick:q},{default:c(()=>[l("儲存")]),_:1})]),r(n(h),{modelValue:e.value.DESCRIPTION,"onUpdate:modelValue":a[7]||(a[7]=i=>e.value.DESCRIPTION=i),class:"w:80%",id:"DESCRIPTION",rows:"5",cols:"50"},null,8,["modelValue"])]),o("div",ge,[Se,r(j,{allowedExtension:"exe",isLoading:e.value.isLoading,isDragging:e.value.isDragging,onHandleFileDrop:E,onHandleFileOpen:E},null,8,["isLoading","isDragging"])])]),o("div",ye,[o("div",ve,[r(n(U)),r(n(d),{class:"ml:5",onClick:a[8]||(a[8]=i=>f()),label:"Save"},{default:c(()=>[l("刪除紀錄")]),_:1}),r(n(d),{class:"ml:5",onClick:b},{default:c(()=>[l("轉EXCEL")]),_:1})]),o("div",Ee,[o("div",Ce,[r(n(_),{value:e.value.col,selection:y.value,"onUpdate:selection":a[9]||(a[9]=i=>y.value=i),selectionMode:"single",metaKeySelection:!1,onRowSelect:T,onRowUnselect:I,tableStyle:"min-width:",scrollable:"",scrollHeight:"500px",resizableColumns:"",columnResizeMode:"fit",showGridlines:"",sortField:"UpDate",sortOrder:-1,ref:"dt"},{default:c(()=>[r(n(S),{field:"Computer",header:"版本",style:{width:"min"}}),r(n(S),{field:"Memo",header:"更新詳述",style:{width:"min"}}),r(n(S),{field:"UpDate",header:"發布時間",sortable:!0,style:{width:"min"}})]),_:1},8,["value","selection"])])])])])],64))}};export{qe as default};
