import{N as v}from"./index-CeSPOaTc.js";import{D as A,g as f,u as P}from"./DragUpload-DXlmm2Yc.js";import{a as m,e as O,c as i,f as c}from"./primevue-CbY-VKnM.js";import{x as I,b as r,o as p,f as T,s as o,h as a,q as N,y as Y,L as t,F as C}from"./@vue-B4Rme-ED.js";import"./vue-router-B47mcnGi.js";/* empty css                   */import"./@master-hp_0R5gD.js";import"./axios-Cm0UX6qg.js";const V={class:"mt:20 flex font:normal font:sans f:20"},_={class:"flex:col mr:2% w:40%"},D={class:"flex flex:row mb:10"},w=a("label",{class:"w:20%",for:"selcode"},"1.選擇系統",-1),k={class:"flex flex:row mb:5"},L=a("label",{class:"w:20%",for:"APSYSNO"},"系統編號",-1),g={class:"flex flex:row mb:5"},x=a("label",{class:"w:20%",for:"VERSION"},"版本",-1),b={class:"flex flex:row mb:5"},y=a("label",{class:"w:20%",for:"NDATE"},"發布日期",-1),R={class:"flex flex:row mb:5"},h=a("label",{class:"w:20%",for:"FileName"},"檔案名稱",-1),F={class:"flex flex:row mb:15"},U=a("label",{class:"w:20%",for:"FILESIZE"},"檔案大小",-1),B={class:"flex flex:row mb:10"},M=a("label",{class:"w:20%",for:"SUBJECT"},"3.更新標題",-1),J={class:"flex flex:row mb:10"},H=a("div",{class:"w:20% flex:col"},[a("label",{class:"",for:"DESCRIPTION"},"4.更新詳述")],-1),Z={class:"flex flex:col"},G=a("label",null,"5.載入程式執行檔(.EXE 並開始上傳主機)",-1),le={__name:"download",setup(j){const d=I("toast"),e=r({version:"",update:"",response:"",SUBJECT:"",DESCRIPTION:"",isLoading:!1,isDragging:!1,selectedsystem:{name:"* 請選擇系統",APSYSNO:"*",ncik:"請選擇系統"},APSYSNO:"",VERSION:"",NDATE:"",FileName:"",FILESIZE:null,col:null}),E=r([{name:"* 請選擇系統",APSYSNO:"*",ncik:"請選擇系統"},{name:"TMGRSYS 高階主管",APSYSNO:"TMGRSYS",ncik:"高階主管"},{name:"ACNTSYS 會計系統",APSYSNO:"ACNTSYS",ncik:"會計系統"},{name:"CASHSYS 出納系統",APSYSNO:"CASHSYS",ncik:"出納系統"},{name:"TAXAPSYS 媒體申報",APSYSNO:"TAXAPSYS",ncik:"媒體申報"},{name:"EPURCSYS 估驗系統",APSYSNO:"EPURCSYS",ncik:"估驗系統"},{name:"EESTISYS 估算系統",APSYSNO:"EESTISYS",ncik:"估算系統"},{name:"PERSNSYS 人事系統",APSYSNO:"PERSNSYS",ncik:"人事系統"},{name:"MSIOSYS 物料倉管",APSYSNO:"MSIOSYS",ncik:"物料倉管"},{name:"PERTSYS 工程進度",APSYSNO:"PERTSYS",ncik:"工程進度"},{name:"PLANSYS 年度預算",APSYSNO:"PLANSYS",ncik:"年度預算"},{name:"DVEPSYS 土地開發",APSYSNO:"DVEPSYS",ncik:"土地開發"},{name:"WSESSYS 水電估算",APSYSNO:"WSESSYS",ncik:"水電估算"},{name:"STEELSYS 鋼筋撿料",APSYSNO:"STEELSYS",ncik:"鋼筋撿料"},{name:"SALESYS 銷售系統",APSYSNO:"SALESYS",ncik:"銷售系統"},{name:"ECHGSYS 變更追加減",APSYSNO:"ECHGSYS",ncik:"變更追加減"},{name:"CMISCCSYS 整合營建桌面",APSYSNO:"CMISCCSYS",ncik:"整合營建桌面"},{name:"CMISC_工地 整合工地桌面",APSYSNO:"CMISC_工地",ncik:"整合工地桌面"},{name:"QCTLSYS 品質查核",APSYSNO:"QCTLSYS",ncik:"品質查核"},{name:"PSALESYS 銷售前置",APSYSNO:"PSALESYS",ncik:"銷售前置"},{name:"ADMISYS 績效考核",APSYSNO:"ADMISYS",ncik:"績效考核"},{name:"MAINTSYS 客戶服務",APSYSNO:"MAINTSYS",ncik:"客戶服務"},{name:"HEALTSYS 健康管理",APSYSNO:"HEALTSYS",ncik:"健康管理"}]);e.value.isLoading=!1;const n=()=>{if(e.value.selectedsystem.APSYSNO=="*"){d.add({severity:"error",summary:"系統別錯誤",detail:"請先選擇系統",life:1e4});return}f("/cl/pd/"+e.value.selectedsystem.APSYSNO).then(s=>{s.data.data.Subject==""?(e.value.response=JSON.stringify(s.data,null,1),e.value.APSYSNO=e.value.selectedsystem.APSYSNO,e.value.VERSION="",e.value.NDATE=new Date(Date.now()).toLocaleString(),e.value.FileName="",e.value.FILESIZE="",e.value.SUBJECT=e.value.selectedsystem.ncik,e.value.DESCRIPTION=""):(e.value.response=JSON.stringify(s.data.data,null,1),e.value.APSYSNO=s.data.data.Apsysno,e.value.VERSION=s.data.data.Version,e.value.NDATE=new Date(s.data.data.Ndate).toLocaleString(),e.value.FileName=s.data.data.Filename,e.value.FILESIZE=s.data.data.Filesize,e.value.SUBJECT=s.data.data.Subject,e.value.DESCRIPTION=s.data.data.Description)}).catch(s=>{d.add({severity:"error",summary:"錯誤",detail:s,life:1e4}),console.error("error:",s)})},u=s=>{if(e.value.selectedsystem.APSYSNO=="*"){d.add({severity:"error",summary:"系統別錯誤",detail:"請先選擇系統",life:1e4});return}if(e.value.APSYSNO==""){d.add({severity:"error",summary:"錯誤",detail:"請先查詢系統資料",life:1e4});return}let l=new FormData;l.append("file",s[0]),l.append("SUBJECT",e.value.SUBJECT),l.append("DESCRIPTION",e.value.DESCRIPTION),e.value.isLoading=!0,P("put","/cl/cl/"+e.value.selectedsystem.APSYSNO,l).then(S=>{e.value.isLoading=!1,e.value.response=S.data.msg,d.add({severity:"success",summary:"上傳成功",detail:s[0].name+" 已上傳到 "+e.value.selectedsystem.APSYSNO,life:15e3}),n()}).catch(S=>{e.value.isLoading=!1,console.error("error:",S)})};return(s,l)=>(p(),T(C,null,[o(v,{text:"下載"}),a("div",V,[a("div",_,[o(t(m),{class:"flex",onClick:n},{default:N(()=>[Y("下載CL")]),_:1}),a("div",D,[w,o(t(O),{class:"mr:10",id:"selcode",modelValue:e.value.selectedsystem,"onUpdate:modelValue":l[0]||(l[0]=S=>e.value.selectedsystem=S),options:E.value,optionLabel:"name",placeholder:"選擇系統",checkmark:"",highlightOnSelect:!0},null,8,["modelValue","options"]),o(t(m),{class:"mr:5",onClick:n},{default:N(()=>[Y("2.查詢")]),_:1})]),a("div",k,[L,o(t(i),{modelValue:e.value.APSYSNO,"onUpdate:modelValue":l[1]||(l[1]=S=>e.value.APSYSNO=S),class:"w:80%",id:"APSYSNO",disabled:"",placeholder:""},null,8,["modelValue"])]),a("div",g,[x,o(t(i),{modelValue:e.value.VERSION,"onUpdate:modelValue":l[2]||(l[2]=S=>e.value.VERSION=S),class:"w:80%",id:"VERSION",disabled:"",placeholder:""},null,8,["modelValue"])]),a("div",b,[y,o(t(i),{modelValue:e.value.NDATE,"onUpdate:modelValue":l[3]||(l[3]=S=>e.value.NDATE=S),class:"w:80%",id:"NDATE",disabled:"",placeholder:""},null,8,["modelValue"])]),a("div",R,[h,o(t(i),{modelValue:e.value.FileName,"onUpdate:modelValue":l[4]||(l[4]=S=>e.value.FileName=S),class:"w:80%",id:"FileName",disabled:"",placeholder:""},null,8,["modelValue"])]),a("div",F,[U,o(t(i),{modelValue:e.value.FILESIZE,"onUpdate:modelValue":l[5]||(l[5]=S=>e.value.FILESIZE=S),class:"w:80%",id:"FILESIZE",disabled:"",placeholder:""},null,8,["modelValue"])]),a("div",B,[M,o(t(c),{modelValue:e.value.SUBJECT,"onUpdate:modelValue":l[6]||(l[6]=S=>e.value.SUBJECT=S),class:"w:80%",id:"SUBJECT",rows:"1",cols:"50"},null,8,["modelValue"])]),a("div",J,[H,o(t(c),{modelValue:e.value.DESCRIPTION,"onUpdate:modelValue":l[7]||(l[7]=S=>e.value.DESCRIPTION=S),class:"w:80%",id:"DESCRIPTION",rows:"5",cols:"50"},null,8,["modelValue"])]),a("div",Z,[G,o(A,{allowedExtension:"exe",isLoading:e.value.isLoading,isDragging:e.value.isDragging,onHandleFileDrop:u,onHandleFileOpen:u},null,8,["isLoading","isDragging"])])])])],64))}};export{le as default};
